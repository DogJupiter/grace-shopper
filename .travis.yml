language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "benewyork-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)

before_deploy:
  - npm run build-client # make the bundle
  - rm -rf node_modules # omit from the tarball, since we skip cleanup
deploy:
  skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
  app: benewyork # see README
  api_key:
    secure: L+wHA/mkezPs6ITi3Uo/KxeazXyjQoJAtoIPSsTTq32/jFwqeXg6h0rAF9H/6W8Jqp3e51JRsjZgAz2HqrR5AgJc2hDNVvk2/a2wr+R
y6zzdu9BxqTqffiGIz+c+28AK1BruLKW+hqUgOMoVR0u6Lz2U2cabRL0oMvNvGeDEdJpT4hvYO/vIF+OB7QWGVCuanyMABZv2sTrSrtGtwbffcR4B8d
ikeA+J/V5vizleo146MidFbP7HkBheVhd6ijbFEHGSbwLFGtQSE1Wo1+Y8c12HziuxNsDaDg5AyZEpwyA7+X54sC/FbrqjJkW0cwa+kW7jVvXJR8dDT
7PwLDzcEfSqG27RN+VpfwkavbO4gj9SGIK+hJ4lkbaNAV92xRJAoinONaU64KqLAlxUf54ge3/Cm4SJhWrEEIFIM8Pj9RsV9srOIfglbjRyQsiFyvL8
NtqBob3udBGBLHa4PkT7ziREcKek4UG3puyax61EiG261xAAHut9yhPX7ft29mCi4ZX0VrwtyeCWeA3x7uScOS9RhF7g2rJLl0+Pt3sqPTx8paaIvXt
nX0jRyqvtpZVxB84IwsPHS81tGElDzNCZkOtxmr6X4DGDMgAr2+l9AZ+BagG4pePU/d2gyX/wshXOmfodqc63+kL5Yd5uSwbeve2pS3g9Zl4cLvDeL+
RVj30=
